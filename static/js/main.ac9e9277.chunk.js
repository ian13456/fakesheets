(this.webpackJsonpfakesheets=this.webpackJsonpfakesheets||[]).push([[0],{24:function(n,e,t){},25:function(n,e,t){"use strict";t.r(e);for(var r=t(0),o=t(11),c=t.n(o),i=t(2),a=t(3),u="4rem",s="1.6rem",l="2rem",d="#bbbbbb",f="#999999",b=t(16),h=t(15),j=t(4),O=t(1),p=Object(r.createContext)({data:[],rows:0,columns:0,highlighted:[],focused:"",setCell:function(){},addRow:function(){},removeRow:function(){},addColumn:function(){},removeColumn:function(){},addHighlight:function(){},removeHighlight:function(){},resetHighlight:function(){},setFocus:function(){},clearFocus:function(){}}),g=[],x=0;x<101;x++)g.push(new Array(27).fill(""));var m,w,v,A,C,k,F,y,I=function(n){return JSON.parse(JSON.stringify(n))},R=function(n){return n.toLowerCase().split("").reduce((function(n,e){return 26*n+parseInt(e,36)-9}),0)-1},S=function(n){for(var e="a".charCodeAt(0),t="z".charCodeAt(0)-e+1,r="";n>=0;)r=String.fromCharCode(n%t+e)+r,n=Math.floor(n/t)-1;return r.toUpperCase()},_=function(n,e){return"".concat(n,"_").concat(S(e))},E=function(n){if(!n)return[-1,-1];var e=n.split("_");return[parseInt(e[0],10),R(e[1])]},H=function(n){var e=Object(r.useState)(g),t=Object(j.a)(e,2),o=t[0],c=t[1],i=Object(r.useState)([]),a=Object(j.a)(i,2),u=a[0],s=a[1],l=Object(r.useState)(""),d=Object(j.a)(l,2),f=d[0],x=d[1],m=o.length,w=(o[0]||[]).length,v=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t){if(n<1||n>=m)return;if(e<1||e>=w)return}x(_(n,e))};return Object(O.jsx)(p.Provider,Object(b.a)({value:{data:o,rows:m,columns:w,highlighted:u,focused:E(f),setCell:function(n,e,t){var r=I(o);r[n][e]=t,c(r)},addRow:function(){var n=I(o),e=E(f||u[0]||"AAAAA_100000"),t=Object(j.a)(e,2),r=t[0],i=t[1];n.splice(r,0,new Array(w).fill("")),c(n),v(r+1,i,!0)},removeRow:function(){var n=I(o),e=E(f||u[0]||"AAAAA_100000"),t=Object(j.a)(e,2),r=t[0],i=t[1];n.splice(r,1),c(n),v(r-1,i)},addColumn:function(){var n=I(o),e=E(f||u[0]||"AAAAA_100000"),t=Object(j.a)(e,2),r=t[0],i=t[1];n.forEach((function(n){return n.splice(i,0,"")})),c(n),v(r,i+1,!0)},removeColumn:function(){var n=I(o),e=E(f||u[0]||"AAAAA_100000"),t=Object(j.a)(e,2),r=t[0],i=t[1];n.forEach((function(n){return n.splice(i,1)})),c(n),v(r,i-1)},addHighlight:function(n,e){s([].concat(Object(h.a)(u),[_(n,e)]))},removeHighlight:function(n,e){s(u.filter((function(t){return t!==_(n,e)})))},setFocus:v,clearFocus:function(){x("")}}},n))},z=function(){return Object(r.useContext)(p)},D=a.a.div(m||(m=Object(i.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: absolute;\n  left: 0;\n  top: 0;\n"]))),J=Object(a.a)(D)(w||(w=Object(i.a)(["\n  flex-direction: column;\n  margin-top: calc("," + ",");\n  width: ",";\n\n  & button {\n    width: 100%;\n    height: 40px;\n    border: 2px solid #bbb;\n    border-left-width: 1px;\n    border-right-width: 1px;\n  }\n"])),l,s,l),B=Object(a.a)(D)(v||(v=Object(i.a)(["\n  margin-left: calc("," + ",");\n  height: ",";\n\n  & button {\n    height: 100%;\n    width: 40px;\n    border: 2px solid #bbb;\n    border-top-width: 1px;\n    border-bottom-width: 1px;\n  }\n"])),l,u,l),L=a.a.button(A||(A=Object(i.a)(["\n  background: white;\n  border: none;\n  color: #666666;\n  font-size: 1em;\n  transition: background 0.2s linear;\n  cursor: pointer;\n\n  &:hover {\n    background: #eee;\n  }\n"]))),M=function(){var n=z(),e=n.addRow,t=n.removeRow,r=n.addColumn,o=n.removeColumn;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(J,{children:[Object(O.jsx)(L,{onClick:e,children:"+"}),Object(O.jsx)(L,{onClick:t,children:"-"})]}),Object(O.jsxs)(B,{children:[Object(O.jsx)(L,{onClick:r,children:"+"}),Object(O.jsx)(L,{onClick:o,children:"-"})]})]})},N=a.a.input(C||(C=Object(i.a)(["\n  background: transparent;\n  border: none;\n  width: 100%;\n  height: 100%;\n  font-size: inherit;\n  color: inherit;\n  &:focus {\n    outline: none;\n  }\n"]))),U=a.a.div(k||(k=Object(i.a)(["\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: ",";\n  height: ",";\n  font-size: 0.8rem;\n  text-align: center;\n  vertical-align: middle;\n  overflow: hidden;\n  outline: none;\n\n  border-bottom: ",";\n  border-right: ",";\n  border-top: solid 1px\n    ",";\n  border-left: solid 1px\n    ",";\n  background: ",";\n  color: ",";\n"])),(function(n){return n.isColIndicator?u:"6rem"}),s,(function(n){return n.isCorner?"3px solid #aaa":""}),(function(n){return n.isCorner?"3px solid #aaa":""}),(function(n){return n.isIndicator?f:d}),(function(n){return n.isIndicator?f:d}),(function(n){return n.isFocused?"#e4fbff":n.isIndicator?"#F8F9FA":"#FFFFFF"}),(function(n){return n.isIndicator?"#666666":"#222222"})),K=function(n){var e=n.data,t=n.row,o=n.col,c=Object(r.useRef)(null),i=z(),a=i.focused,u=i.setFocus,s=i.setCell,l=Object(r.useState)(!1),d=Object(j.a)(l,2),f=d[0],b=d[1],h=Object(r.useState)(""),p=Object(j.a)(h,2),g=p[0],x=p[1],m=Object(j.a)(a,2),w=m[0],v=m[1],A=0===t,C=0===o,k=A||C,F=A&&C,y=w===t&&v===o,I=F?"":k?A?S(o-1):t:e,R=function(){s(t,o,g),x(""),b(!1)},_=function(n){b(!0),x(n)};return Object(r.useEffect)((function(){c.current&&y&&c.current.focus()}),[y]),Object(O.jsx)(U,{ref:c,tabIndex:y?"-1":"0",onMouseDown:function(){k||u(t,o)},onDoubleClick:function(){k||(console.log(t,o),u(t,o),_(e))},onKeyDown:function(n){if(f)"Enter"===n.key&&(R(),u(t+1,o));else switch(n.key){case"ArrowUp":u(t-1,o);break;case"ArrowDown":u(t+1,o);break;case"ArrowLeft":u(t,o-1);break;case"ArrowRight":u(t,o+1);break;case"Enter":_(e);break;default:_("")}},isCorner:F,isColIndicator:C,isIndicator:k,isFocused:y,children:f?Object(O.jsx)(N,{autoFocus:!0,value:g,onChange:function(n){return x(n.target.value)},onBlur:R,style:{padding:2}}):I})},P=a.a.div(F||(F=Object(i.a)(["\n  display: flex;\n"]))),q=function(n){var e=n.row,t=n.data;return Object(O.jsx)(P,{children:t.map((function(n,t){return Object(O.jsx)(K,{data:n,row:e,col:t},"".concat(e,"_").concat(t))}))})},G=a.a.div(y||(y=Object(i.a)(["\n  display: flex;\n  flex-direction: column;\n  width: fit-content;\n  border: solid 1px #555;\n  margin-left: ",";\n  margin-top: ",";\n"])),l,l),Q=function(){var n=z(),e=n.data,t=n.rows;return Object(O.jsx)(G,{children:e.map((function(n,e){return Object(O.jsx)(q,{row:e,count:t,data:n},e+"r")}))})},T=function(){return Object(O.jsxs)(H,{children:[Object(O.jsx)(M,{}),Object(O.jsx)(Q,{})]})};t(24);c.a.render(Object(O.jsx)(T,{}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.ac9e9277.chunk.js.map